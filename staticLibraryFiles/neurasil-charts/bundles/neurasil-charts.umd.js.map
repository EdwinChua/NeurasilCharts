{"version":3,"file":"neurasil-charts.umd.js","sources":["ng://neurasil-charts/lib/models/NeurasilChartType.ts","ng://neurasil-charts/lib/neurasil-charts.service.ts","ng://neurasil-charts/lib/pipes/neurasil-data-filter/neurasil-data-filter.pipe.ts","ng://neurasil-charts/lib/neurasil-charts.component.ts","ng://neurasil-charts/lib/neurasil-charts-toolbar/neurasil-charts-toolbar.component.ts","ng://neurasil-charts/lib/neurasil-charts.module.ts"],"sourcesContent":["export enum NEURASIL_CHART_TYPE {\r\n    BAR = 0,\r\n    BAR_LINE = 1,\r\n    STACKED = 2,\r\n    LINE = 3,\r\n    PIE = 4,\r\n    DONUT = 5,\r\n    GRID = 6,\r\n    HORIZONTAL_BAR = 7,\r\n    STACKED_PARETO = 9\r\n}","import { Injectable } from '@angular/core';\nimport { NEURASIL_CHART_TYPE } from './models';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NeurasilChartsService {\n\n  constructor() { }\n\n\n  parseDataFromDatasource(chartType: NEURASIL_CHART_TYPE, incomingData: Array<any>, swapLabelsAndDatasets: boolean): { _cornerstone: string, _formatObject: { prefix: string, suffix: string }, data: Array<any> } {\n    let returnData = {\n      _cornerstone: \"\",\n      _formatObject: null,\n      data: null\n    }\n\n    let data = JSON.parse(JSON.stringify(incomingData)); // make a copy of the data\n\n    let k_arr_Temp = Object.keys(data[0]);\n\n\n    let k_arr = Object.keys(data[0]);\n    let cDat = {};\n    for (let i = 0; i < k_arr.length; i++) {\n      let currKey = k_arr[i]\n      cDat[currKey] = [];\n      for (var j in data) {\n        cDat[k_arr[i]].push(data[j][currKey]);\n      }\n    }\n\n\n    let formatObj = {};\n    let k_arr_new = Object.keys(cDat);\n    returnData._cornerstone = k_arr_new[0];\n\n    for (let i = 0; i < k_arr_new.length; i++) { // for each key in formatted object\n      let currKey = k_arr_new[i];\n      formatObj[currKey] = {};\n      if (currKey != returnData._cornerstone) {\n        let testItem;\n        for (var j in cDat[currKey]) {\n          if (cDat[currKey][j]) { // set test item and break if the value is not null\n            testItem = cDat[currKey][j];\n            break;\n          }\n        }\n\n        let prefix = \"\";\n        let suffix = \"\";\n        if (testItem) {\n          if (!isNumber(testItem)) {\n            if (isNumber(testItem.substr(1))) {\n              prefix = testItem.substr(0, 1);\n\n            } else if (isNumber(testItem.substr(0, testItem.length - 1))) {\n              suffix = testItem.substr(testItem.length - 1);\n            }\n          }\n        }\n\n        formatObj[currKey] = {\n          prefix: prefix,\n          suffix: suffix\n        }\n\n        // format each data in the individual arrays\n        for (var k in cDat[currKey]) {\n          if (prefix != \"\") {\n            cDat[currKey][k] = cDat[currKey][k].replace(prefix, \"\");\n          }\n          if (suffix != \"\") {\n            cDat[currKey][k] = cDat[currKey][k].replace(suffix, \"\");\n          }\n\n          //newStr = cDat\n          //replaceData.push()\n        }\n\n      } else if (currKey == returnData._cornerstone) {\n        formatObj[currKey] = {\n          prefix: \"\",\n          suffix: \"\"\n        }\n      }\n\n    }\n\n\n    if (!swapLabelsAndDatasets) {\n      // do nothing;\n      // return cDat;\n    }\n    else {\n      let cDat_New = {};\n\n      cDat_New[returnData._cornerstone] = Object.keys(cDat);\n      let index = cDat_New[returnData._cornerstone].indexOf(returnData._cornerstone);\n      if (index > -1) {\n        cDat_New[returnData._cornerstone].splice(index, 1);\n      }\n      for (let i = 0; i < cDat[returnData._cornerstone].length; i++) {\n        cDat_New[cDat[returnData._cornerstone][i]] = [];\n        for (var j in cDat_New[returnData._cornerstone]) {\n          cDat_New[cDat[returnData._cornerstone][i]].push(cDat[cDat_New[returnData._cornerstone][j]][i])\n        }\n      }\n      //return cDat_New;\n      cDat = cDat_New; // reassign to cDat\n    }\n\n\n    if (chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n      // Add suffixes to auto-generated lines\n      formatObj[\"Pareto\"] = {\n        prefix: \"\",\n        suffix: \"%\"\n      }\n      formatObj[\"80% line\"] = {\n        prefix: \"\",\n        suffix: \"%\"\n      }\n    }\n\n    function isNumber(value: string | number): boolean {\n      return ((value != null) && !isNaN(Number(value.toString())));\n    }\n\n    returnData._formatObject = formatObj;\n    returnData.data = cDat;\n    //console.log(cDat);\n    return returnData;\n  }\n\n\n  chartObjectBuilder(chartType, chartData, useAltAxis, title, yAxisLabelText, yAxisLabelText_Alt, xAxisLabelText, cornerstone, swapLabelsAndDatasets, formatObject) {\n    //const chartTypes = NexusChartjsChart.chartTypes;\n    if ((chartType == NEURASIL_CHART_TYPE.BAR || chartType == NEURASIL_CHART_TYPE.HORIZONTAL_BAR || chartType == NEURASIL_CHART_TYPE.LINE || chartType == NEURASIL_CHART_TYPE.STACKED || chartType == NEURASIL_CHART_TYPE.PIE || chartType == NEURASIL_CHART_TYPE.DONUT) && useAltAxis == true) {\n      console.warn(\"You have enabled alternate axis on a (unsupported) chart type. It has been set to false\");\n      useAltAxis = false;\n    }\n\n    if (chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n      yAxisLabelText_Alt = \"Pareto %\";\n    }\n\n    let options: any = {\n      maintainAspectRatio: false,\n      responsive: true,\n    };\n    if (title) {\n      options.title = {\n        display: true,\n        text: title\n      }\n    }\n\n    let yAxisLabel = { display: false, labelString: \"\" }\n    if (yAxisLabelText) {\n      yAxisLabel.display = true;\n      yAxisLabel.labelString = yAxisLabelText;\n    }\n\n    let yAxisLabel_Alt = { display: false, labelString: \"\" }\n    if (yAxisLabelText_Alt) {\n      yAxisLabel_Alt.display = true;\n      yAxisLabel_Alt.labelString = yAxisLabelText_Alt;\n    }\n\n    let xAxisLabel = { display: false, labelString: \"\" };\n    if (xAxisLabelText) {\n      xAxisLabel.display = true;\n      xAxisLabel.labelString = xAxisLabelText;\n    }\n\n    if (chartType != NEURASIL_CHART_TYPE.PIE && chartType != NEURASIL_CHART_TYPE.DONUT) {\n      if (chartType == NEURASIL_CHART_TYPE.STACKED || chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n\n        options.scales = {\n          xAxes: [{\n            stacked: true,\n            scaleLabel: xAxisLabel\n          }],\n          yAxes: [{\n            stacked: true,\n            scaleLabel: yAxisLabel\n          }]\n        }\n\n        if (chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n          let altAxisObj: any = {\n            id: 'yAxis-alt',\n            display: 'auto',\n            ticks: {\n              beginAtZero: true,\n            },\n            position: 'right',\n            scaleLabel: yAxisLabel_Alt\n          }\n          altAxisObj.ticks.min = 0;\n          altAxisObj.ticks.max = 100;\n          altAxisObj.ticks.stepSize = 80\n\n          options.scales.yAxes.push(altAxisObj)\n\n        }\n\n      } else {\n        options.scales = {\n          xAxes: [{\n            scaleLabel: xAxisLabel\n          }],\n          yAxes: [{\n            id: 'yAxis',\n            ticks: {\n              beginAtZero: true,\n            },\n            scaleLabel: yAxisLabel\n          },]\n        }\n\n        if (useAltAxis) {\n          let altAxisObj: any = {\n            id: 'yAxis-alt',\n            display: 'auto',\n            ticks: {\n              beginAtZero: true,\n            },\n            position: 'right',\n            scaleLabel: yAxisLabel_Alt\n          }\n          if (chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n            altAxisObj.ticks.min = 0;\n            altAxisObj.ticks.max = 100;\n            altAxisObj.ticks.stepSize = 80\n          }\n          options.scales.yAxes.push(altAxisObj)\n\n        }\n      }\n    }\n\n    let type;\n    if (chartType == NEURASIL_CHART_TYPE.LINE) {\n      type = 'line'\n    } else if (chartType == NEURASIL_CHART_TYPE.BAR ||\n      chartType == NEURASIL_CHART_TYPE.BAR_LINE ||\n      chartType == NEURASIL_CHART_TYPE.STACKED ||\n      chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n      type = 'bar'\n    } else if (chartType == NEURASIL_CHART_TYPE.HORIZONTAL_BAR) {\n      type = 'horizontalBar'\n    } else if (chartType == NEURASIL_CHART_TYPE.PIE) {\n      type = 'pie'\n    }\n    else if (chartType == NEURASIL_CHART_TYPE.DONUT) {\n      type = 'doughnut'\n    }\n\n\n    let THIS = this;\n\n    // tooltip & title prefix/suffix addition. Title uses default configs for bar /line\n    options.tooltips = {};\n    options.tooltips.callbacks = {};\n\n    if (chartType == NEURASIL_CHART_TYPE.BAR ||\n      chartType == NEURASIL_CHART_TYPE.BAR_LINE ||\n      chartType == NEURASIL_CHART_TYPE.LINE ||\n      chartType == NEURASIL_CHART_TYPE.STACKED ||\n      chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n      options.tooltips.callbacks.label = function (tooltipItem, data) {\n        var label = data.datasets[tooltipItem.datasetIndex].label || '';\n        if (label) {\n          label += ': ';\n        }\n        if (swapLabelsAndDatasets) {\n          label += `${formatObject[tooltipItem.xLabel].prefix}` + tooltipItem.yLabel + `${formatObject[tooltipItem.xLabel].suffix}`;\n        } else {\n\n          let objKeys = Object.keys(formatObject);\n          let key = objKeys[tooltipItem.datasetIndex + 1]\n          let formatObj = formatObject[key];\n          label += `${formatObj.prefix}` + tooltipItem.yLabel + `${formatObj.suffix}`;;\n        }\n        return label;\n      }\n    } else if (chartType == NEURASIL_CHART_TYPE.PIE || chartType == NEURASIL_CHART_TYPE.DONUT) {\n      options.tooltips.callbacks.label = function (tooltipItem, data) {\n        var label = data.labels[tooltipItem.index];\n        if (label) {\n          label += ': ';\n        }\n        let formatObj;\n        if (swapLabelsAndDatasets) {\n          formatObj = formatObject[data.labels[tooltipItem.index]];\n\n        } else {\n          formatObj = formatObject[data.datasets[tooltipItem.datasetIndex].label];\n\n        }\n        label += `${formatObj.prefix}${data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index]}${formatObj.suffix}`;\n        return label;\n      }\n      options.tooltips.callbacks.title = function (tooltipItem, data) {\n        return data.datasets[tooltipItem[0].datasetIndex].label;\n      }\n    } else if (chartType == NEURASIL_CHART_TYPE.HORIZONTAL_BAR) {\n      options.tooltips.callbacks.label = function (tooltipItem, data) {\n\n        var label = data.datasets[tooltipItem.datasetIndex].label;\n        if (label) {\n          label += ': ';\n        }\n        let formatObj;\n        if (swapLabelsAndDatasets) {\n          formatObj = formatObject[data.labels[tooltipItem.index]];\n\n        } else {\n          formatObj = formatObject[data.datasets[tooltipItem.datasetIndex].label];\n\n        }\n        label += `${formatObj.prefix}${data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index]}${formatObj.suffix}`;\n        return label;\n      }\n      options.tooltips.callbacks.title = function (tooltipItem, data) {\n\n        return tooltipItem[0].yLabel;\n      }\n    }\n\n\n    let returnOpts = {\n      type: type,\n      data: this.dataParser(chartData, useAltAxis, chartType, cornerstone, swapLabelsAndDatasets),\n      options: options\n    }\n    return returnOpts;\n  }\n\n  dataParser(chartData, useAltAxis /*boolean*/, chartType /*chartType enum*/, cornerstone, swapLabelsAndDatasets) {\n\n    // helper function to get color array for chart. cycles through when \n    function getPalette(opacity, noOfColors) {\n      let colors = [\n        `rgba(199,233,180,${opacity})`,\n        `rgba(127,205,187,${opacity})`,\n        `rgba(65,182,196,${opacity})`,\n        `rgba(29,145,192,${opacity})`,\n        `rgba(34,94,168,${opacity})`,\n        `rgba(37,52,148,${opacity})`,\n        `rgba(8,29,88,${opacity})`,\n        `rgba(254,178,76,${opacity})`,\n        `rgba(253,141,60,${opacity})`,\n        `rgba(252,78,42,${opacity})`,\n        `rgba(227,26,28,${opacity})`,\n        `rgba(189,0,38,${opacity})`,\n        `rgba(128,0,38,${opacity})`\n      ];\n\n      if (noOfColors > colors.length) { // if more colors are required than available, cycle through beginning again\n        let diff = noOfColors - colors.length;\n        let colorsLength = colors.length;\n        for (var i = 0; i <= diff; i) { // NO INCREMENT HERE\n          for (var j = 0; j < colorsLength; j++) {\n            colors.push(colors[j])\n            i++; // INCREMENT HERE\n          }\n        }\n      }\n\n      return colors;\n    }\n\n    let colorPalatte;\n    let bgColorPalatte\n    if (!swapLabelsAndDatasets) {\n      colorPalatte = getPalette(1, chartData[cornerstone].length)\n      bgColorPalatte = getPalette(0.3, chartData[cornerstone].length)\n    } else {\n      colorPalatte = getPalette(1, Object.keys(chartData).length)\n      bgColorPalatte = getPalette(0.3, Object.keys(chartData).length)\n    }\n\n\n\n    let dataSets = [];\n    let objKeys = Object.keys(chartData);\n    let index = objKeys.indexOf(cornerstone);\n    if (index > -1) {\n      objKeys.splice(index, 1);\n    }\n\n\n    for (let i = 0; i < objKeys.length; i++) {\n\n      let yAxis = 'yAxis';\n      if (useAltAxis) {\n        if (i > 0) {\n          yAxis += '-alt';\n        }\n      }\n\n      let dataSet: any = {\n        label: objKeys[i],\n        data: chartData[objKeys[i]],\n        backgroundColor: bgColorPalatte[i],\n        borderColor: colorPalatte[i],\n        borderWidth: 2\n      };\n\n\n      if (chartType == NEURASIL_CHART_TYPE.BAR_LINE) { // ignores stacked and bar options. Makes assumption that only 1st dataset is bar\n        if (i == 0) {\n          dataSet.type = 'bar';\n        } else {\n          dataSet.type = 'line';\n        }\n      }\n\n\n\n\n      if (chartType == NEURASIL_CHART_TYPE.BAR || chartType == NEURASIL_CHART_TYPE.HORIZONTAL_BAR || chartType == NEURASIL_CHART_TYPE.STACKED || chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n        dataSet.backgroundColor = bgColorPalatte[i];\n        dataSet.borderColor = colorPalatte[i];\n      } else if (chartType == NEURASIL_CHART_TYPE.BAR_LINE || chartType == NEURASIL_CHART_TYPE.LINE) {\n        if (dataSet.type == 'bar') {\n          dataSet.backgroundColor = bgColorPalatte[i];\n          dataSet.borderColor = colorPalatte[i];\n        } else {\n          dataSet.borderColor = colorPalatte[i];\n          dataSet.backgroundColor = 'rgba(0,0,0,0)';\n        }\n      } else if (chartType == NEURASIL_CHART_TYPE.PIE || chartType == NEURASIL_CHART_TYPE.DONUT) {// overwrite single color assignment to array.\n        dataSet.backgroundColor = bgColorPalatte;\n        dataSet.borderColor = colorPalatte;\n      }\n\n\n      if (chartType != NEURASIL_CHART_TYPE.PIE && chartType != NEURASIL_CHART_TYPE.DONUT) {\n        if (chartType != NEURASIL_CHART_TYPE.STACKED && chartType != NEURASIL_CHART_TYPE.STACKED_PARETO) {\n          dataSet.yAxisID = yAxis;\n        }\n      }\n\n      dataSets.push(dataSet);\n    }\n    let returnData = {\n      labels: chartData[cornerstone],\n      datasets: dataSets\n    }\n    return returnData;\n  }\n\n  performParetoAnalysis(props){\n    //modify chart object\n    let localSumArr = [];\n    let totalSum = 0;\n    for (let j = 0; j < props.data.datasets[0].data.length; j++) {\n      let sum = 0;\n      for (let i = 0; i < props.data.datasets.length; i++) {\n        let val = parseFloat(props.data.datasets[i].data[j]);\n        if (isNaN(val)) {\n          val = 0;\n        }\n        sum += val\n      }\n      localSumArr.push(sum);\n      totalSum += sum;\n    }\n\n    //sort data by local sum\n    let newArr = [];\n    for (let i = 0; i < localSumArr.length; i++) {\n      let o = {\n        sum: localSumArr[i],\n        labels: props.data.labels[i],\n      }\n      for (let j = 0; j < props.data.datasets.length; j++) {\n        o[j] = props.data.datasets[j].data[i];\n      }\n      newArr.push(o)\n    }\n\n    //sort descending\n    newArr.sort(function (a, b) {\n      return ((a.sum < b.sum) ? 1 : ((a.sum == b.sum) ? 0 : -1));\n    });\n\n    //rebuild and reassign labels array\n    let newLabelsArray = []\n    for (let i =0; i < newArr.length; i++){\n      newLabelsArray.push(newArr[i][\"labels\"]);\n    }\n    props.data.labels = newLabelsArray;\n\n    //rebuild and reassign data array for each dataset\n\n    for (let j = 0; j < props.data.datasets.length; j++) {\n      let data = [];\n      for (let i = 0; i < newArr.length; i++){\n        data.push(newArr[i][j])\n      }\n      props.data.datasets[j].data = data;\n    }\n\n    let sortedlocalSumArr = [];\n    for (let i = 0 ; i < newArr.length; i++){\n      sortedlocalSumArr.push(newArr[i].sum)\n    }\n\n\n    // calculate and push pareto line, also populate 80%line array\n    let rollingSum = 0;\n    let paretoLineValues = [];\n    let eightyPercentLine = [];\n\n    for (let i = 0 ; i < sortedlocalSumArr.length; i++){\n      rollingSum += sortedlocalSumArr[i];\n      let paretoVal = rollingSum/totalSum * 100;\n      paretoLineValues.push( Math.floor(paretoVal * 100) / 100 );\n      eightyPercentLine.push(80)\n    }\n    props.data.datasets.push({\n      \"label\":\"Pareto\",\n      \"data\":paretoLineValues,\n      \"backgroundColor\":\"rgba(0,0,0,0)\",\n      \"borderColor\":\"rgba(0,0,0,0.8)\",\n      \"borderWidth\":2,\n      \"type\":\"line\",\n      \"yAxisID\":\"yAxis-alt\"\n    })\n    // push 80% line\n    props.data.datasets.push({\n      \"label\":\"80% line\",\n      \"data\":eightyPercentLine,\n      \"backgroundColor\":\"rgba(0,0,0,0)\",\n      \"borderColor\":\"rgba(0,0,0,0.8)\",\n      \"borderWidth\":2,\n      \"type\":\"line\",\n      \"yAxisID\":\"yAxis-alt\"\n    })\n  }\n\n    // unused. Migrated code to NeurasilDataFilterPipe\n  // filterData(data: Array<any>, datasetFilter: string) {\n\n  //   if (datasetFilter) {\n  //     let filterTerms = datasetFilter.split(',');\n  //     let includeTerms = [];\n  //     let excludeTerms = [];\n  //     let includeColumns = [];\n  //     let excludeColumns = [];\n  //     for (let i in filterTerms) {\n  //       if (filterTerms[i] != null && filterTerms[i] != undefined && filterTerms[i].length > 1) {\n  //         let term = filterTerms[i].trim().toLowerCase();\n  //         if (term[0] == \"-\") {\n  //           excludeTerms.push(term.replace(\"-\", \"\").trim());\n  //         } else if (term[0] == \"~\") {\n  //           if (term[1] == \"!\") {\n  //             excludeColumns.push(term.replace(\"~!\", \"\").trim());\n  //           } else {\n  //             includeColumns.push(term.replace(\"~\", \"\").trim())\n  //           }\n  //         } else {\n  //           includeTerms.push(term.trim())\n  //         }\n  //       }\n  //     }\n\n\n  //     let data_Filtered = data.filter(function (dataItem) {\n  //       let k_arr = Object.keys(dataItem);\n  //       let searchString = \"\";\n  //       for (let i in k_arr) {\n  //         let currKey = k_arr[i];\n  //         let value = dataItem[currKey];\n  //         searchString += value + \" \";\n  //       }\n  //       searchString = searchString.toLowerCase().trim();\n  //       let currentPassingStatus = false;\n  //       if (includeTerms.length > 0) {\n  //         for (let i in includeTerms) {\n  //           if (searchString.includes(includeTerms[i])) {\n  //             currentPassingStatus = true;\n  //             break;\n  //           }\n  //         }\n  //       } else {\n  //         currentPassingStatus = true;\n  //       }\n  //       if (excludeTerms.length > 0 && currentPassingStatus) {\n  //         for (let i in excludeTerms) {\n  //           if (searchString.includes(excludeTerms[i])) {\n  //             currentPassingStatus = false;\n  //             break;\n  //           }\n  //         }\n  //       }\n  //       if (currentPassingStatus) {\n\n  //         return dataItem;\n  //       }\n  //     });\n\n  //     if (includeColumns.length > 0 && excludeColumns.length > 0) {\n  //       window.alert(\"Unsupported usage of include & exclude columns. Things may break\")\n  //     }\n  //     //after filtering is complete, remove columns from clone of data\n  //     else if (excludeColumns.length > 0) {\n  //       data_Filtered = JSON.parse(JSON.stringify(data_Filtered))\n  //       //console.log(\"here\")\n  //       for (var h in data_Filtered) {\n  //         let dataItem = data_Filtered[h];\n  //         let k_arr = Object.keys(dataItem);\n  //         //for (let i in k_arr) {\n  //         for (let i = 0; i < k_arr.length; i++) {\n  //           if (i > 0) {// skip the first column. Do not allow user to delete first column\n  //             for (var j in excludeColumns) {\n  //               let processedKey = k_arr[i].trim().toLowerCase();\n  //               if (processedKey.includes(excludeColumns[j])) {\n  //                 delete dataItem[k_arr[i]];\n  //               }\n  //             }\n  //           }\n  //         }\n  //       }\n  //     }\n\n  //     else if (includeColumns.length > 0) {\n  //       data_Filtered = JSON.parse(JSON.stringify(data_Filtered));\n  //       for (var h in data_Filtered) {\n  //         let dataItem = data_Filtered[h];\n  //         let k_arr = Object.keys(dataItem);\n  //         for (let i = 0; i < k_arr.length; i++) {\n  //           if (i > 0) {// skip the first column. Needed?\n  //             let processedKey = k_arr[i].trim().toLowerCase();\n  //             let keepColumn = false;\n  //             for (var j in includeColumns) {\n  //               if (processedKey.includes(includeColumns[j])) {\n  //                 keepColumn = true;\n  //               }\n  //               // if (!processedKey.includes(includeColumns[j])) {\n  //               //     delete dataItem[k_arr[i]];\n  //               // }\n  //             }\n  //             if (!keepColumn) {\n  //               delete dataItem[k_arr[i]];\n  //             }\n  //           }\n  //         }\n  //       }\n  //     }\n\n  //     return data_Filtered;\n  //   }\n  //   return data; // if no filter, return original data\n  // }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'neurasilDataFilter',\n  pure: true\n})\nexport class NeurasilDataFilter implements PipeTransform {\n\n  transform(data: any[], filterText: string): any {\n    if (filterText === \"\" || filterText === null || filterText === undefined) {\n      return data;\n    } else {\n      if (filterText) {\n        let filterTerms = filterText.split(',');\n        let includeTerms = [];\n        let excludeTerms = [];\n        let includeColumns = [];\n        let excludeColumns = [];\n        for (let i in filterTerms) {\n          if (filterTerms[i] != null && filterTerms[i] != undefined && filterTerms[i].length > 1) {\n            let term = filterTerms[i].trim().toLowerCase();\n            if (term[0] == \"-\") {\n              excludeTerms.push(term.replace(\"-\", \"\").trim());\n            } else if (term[0] == \"~\") {\n              if (term[1] == \"!\") {\n                excludeColumns.push(term.replace(\"~!\", \"\").trim());\n              } else {\n                includeColumns.push(term.replace(\"~\", \"\").trim())\n              }\n            } else {\n              includeTerms.push(term.trim())\n            }\n          }\n        }\n\n\n        let data_Filtered = data.filter(function (dataItem) {\n          let k_arr = Object.keys(dataItem);\n          let searchString = \"\";\n          for (let i in k_arr) {\n            let currKey = k_arr[i];\n            let value = dataItem[currKey];\n            searchString += value + \" \";\n          }\n          searchString = searchString.toLowerCase().trim();\n          let currentPassingStatus = false;\n          if (includeTerms.length > 0) {\n            for (let i in includeTerms) {\n              if (searchString.includes(includeTerms[i])) {\n                currentPassingStatus = true;\n                break;\n              }\n            }\n          } else {\n            currentPassingStatus = true;\n          }\n          if (excludeTerms.length > 0 && currentPassingStatus) {\n            for (let i in excludeTerms) {\n              if (searchString.includes(excludeTerms[i])) {\n                currentPassingStatus = false;\n                break;\n              }\n            }\n          }\n          if (currentPassingStatus) {\n\n            return dataItem;\n          }\n        });\n\n        if (includeColumns.length > 0 && excludeColumns.length > 0) {\n          window.alert(\"Unsupported usage of include & exclude columns. Things may break\")\n        }\n        //after filtering is complete, remove columns from clone of data\n        else if (excludeColumns.length > 0) {\n          data_Filtered = JSON.parse(JSON.stringify(data_Filtered))\n          //console.log(\"here\")\n          for (var h in data_Filtered) {\n            let dataItem = data_Filtered[h];\n            let k_arr = Object.keys(dataItem);\n            //for (let i in k_arr) {\n            for (let i = 0; i < k_arr.length; i++) {\n              if (i > 0) {// skip the first column. Do not allow user to delete first column\n                for (var j in excludeColumns) {\n                  let processedKey = k_arr[i].trim().toLowerCase();\n                  if (processedKey.includes(excludeColumns[j])) {\n                    delete dataItem[k_arr[i]];\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        else if (includeColumns.length > 0) {\n          data_Filtered = JSON.parse(JSON.stringify(data_Filtered));\n          for (var h in data_Filtered) {\n            let dataItem = data_Filtered[h];\n            let k_arr = Object.keys(dataItem);\n            for (let i = 0; i < k_arr.length; i++) {\n              if (i > 0) {// skip the first column. Needed?\n                let processedKey = k_arr[i].trim().toLowerCase();\n                let keepColumn = false;\n                for (var j in includeColumns) {\n                  if (processedKey.includes(includeColumns[j])) {\n                    keepColumn = true;\n                  }\n                  // if (!processedKey.includes(includeColumns[j])) {\n                  //     delete dataItem[k_arr[i]];\n                  // }\n                }\n                if (!keepColumn) {\n                  delete dataItem[k_arr[i]];\n                }\n              }\n            }\n          }\n        }\n\n        return data_Filtered;\n      }\n      return data; // if no filter, return original data\n    }\n  }\n\n}\n","import { Component, OnInit, ViewChild, ElementRef, AfterViewInit, Input, OnChanges, SimpleChanges, Output, EventEmitter } from '@angular/core';\nimport { NeurasilChartsService } from './neurasil-charts.service';\nimport { NEURASIL_CHART_TYPE } from './models';\nimport { NeurasilDataFilter } from './pipes';\n\nimport * as Chart from 'chart.js';\n\n@Component({\n  selector: 'neurasil-charts',\n  templateUrl: './neurasil-charts.component.html',\n  styleUrls: ['./neurasil-charts.component.sass'],\n  providers: [NeurasilDataFilter]\n})\nexport class NeurasilChartsComponent implements OnInit, AfterViewInit, OnChanges {\n\n  @ViewChild('neurasilChartCanvas', { static: false }) canvas: ElementRef;\n\n  /**\n   * Data to plot\n   */\n  @Input() data: Array<any>;\n\n  @Input() showToolbar: boolean = true;\n  @Output() showToolbarChange = new EventEmitter();\n  /**\n   * User-defined default chart type\n   */\n  @Input() chartType: NEURASIL_CHART_TYPE;\n  @Output() chartTypeChange = new EventEmitter();\n\n  @Input() useAltAxis: boolean = true; // not sure if needed\n  @Input() chartTitle: string = \"\";\n  @Input() xAxisLabelText: string = \"\";\n  @Input() yAxisLabelText_Alt: string = \"\";\n  @Input() yAxisLabelText: string = \"\";\n\n  @Input() swapLabelsAndDatasets: boolean;\n  @Output() swapLabelsAndDatasetsChange = new EventEmitter();\n  @Input() globalFilter: string = \"\";\n\n  toolbarProps = {\n    chartType: this.chartType ? this.chartType : NEURASIL_CHART_TYPE.BAR,\n    _datasetFilter: \"\",\n    swapLabelsAndDatasets: false\n  };\n\n  _canvas: any;\n  hasData: boolean; // for the purpose of checking length in html template\n\n\n  constructor(public neurasilChartsService: NeurasilChartsService, public neurasilDataFilter: NeurasilDataFilter) { }\n\n  ngOnInit() {\n    if (this.chartType) {\n      this.toolbarProps.chartType = this.chartType;\n    }\n\n    if (this.swapLabelsAndDatasets) {\n      this.toolbarProps.swapLabelsAndDatasets = this.swapLabelsAndDatasets\n    }\n\n    this.hasData = (this.data && this.data.length > 0);\n  }\n  ngAfterViewInit() {\n    this.drawChart();\n  }\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes) {\n      console.log(changes) \n      this.drawChart();\n    }\n  }\n\n  updateToolbarProps(ev) {\n    console.log(\">>>\" , ev)\n    console.log(this.toolbarProps)\n    this.chartTypeChange.emit(this.toolbarProps.chartType);\n    this.showToolbarChange.emit(this.showToolbar);\n    this.swapLabelsAndDatasetsChange.emit(this.toolbarProps.swapLabelsAndDatasets)\n    this.drawChart();\n  }\n\n\n  drawChart() {\n    if (this._canvas) {\n      this._canvas.destroy();\n    }\n    if (this.canvas) {\n      var ctx = this.canvas.nativeElement.getContext('2d');\n      let filterString = \"\"\n      if (this.globalFilter.length > 0) {\n        filterString += this.globalFilter + \",\"\n      }\n      filterString += this.toolbarProps._datasetFilter;\n      let filteredData = this.neurasilDataFilter.transform(this.data, filterString);\n      console.log(filteredData);\n      this.hasData = (filteredData && filteredData.length > 0);\n      if (this.hasData) {\n        let o = this.neurasilChartsService.parseDataFromDatasource(this.toolbarProps.chartType, filteredData, this.toolbarProps.swapLabelsAndDatasets);\n        let props = this.neurasilChartsService.chartObjectBuilder(this.toolbarProps.chartType, o.data, this.useAltAxis, this.chartTitle, this.yAxisLabelText, this.yAxisLabelText_Alt, this.xAxisLabelText, o._cornerstone, this.toolbarProps.swapLabelsAndDatasets, o._formatObject);\n        if (this.toolbarProps.chartType == NEURASIL_CHART_TYPE.STACKED_PARETO) {\n          this.neurasilChartsService.performParetoAnalysis(props); // modify chart props object\n        }\n        this._canvas = new Chart(ctx, props);\n      }\n    }\n  }\n}\n","import { Component,Input, Output, EventEmitter } from '@angular/core';\r\n\r\nimport { NEURASIL_CHART_TYPE } from '../models/NeurasilChartType'\r\n\r\n@Component({\r\n  selector: 'neurasil-charts-toolbar',\r\n  templateUrl: './neurasil-charts-toolbar.component.html',\r\n  styleUrls: ['./neurasil-charts-toolbar.component.sass']\r\n})\r\nexport class NeurasilChartsToolbarComponent {\r\n  @Input() toolbarProps;\r\n  @Output() toolbarPropsChange = new EventEmitter<any>();\r\n  NEURASIL_CHART_TYPE = NEURASIL_CHART_TYPE;\r\n  toolbarPropsChanged(ev){\r\n    //console.log(ev)\r\n    this.toolbarPropsChange.emit(this.toolbarProps);\r\n  }\r\n}","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { NeurasilChartsToolbarComponent } from './neurasil-charts-toolbar/neurasil-charts-toolbar.component'\nimport { NeurasilChartsComponent } from './neurasil-charts.component';\nimport { NeurasilDataFilter } from './pipes/neurasil-data-filter/neurasil-data-filter.pipe';\n\n@NgModule({\n  declarations: [\n    NeurasilChartsComponent,\n    NeurasilChartsToolbarComponent,\n    NeurasilDataFilter\n  ],\n  imports: [\n    CommonModule,\n    FormsModule\n  ],\n  exports: [NeurasilChartsComponent,NeurasilDataFilter]\n})\nexport class NeurasilChartsModule { }\n"],"names":["Injectable","Pipe","EventEmitter","Component","ViewChild","Input","Output","NgModule","CommonModule","FormsModule"],"mappings":"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"}